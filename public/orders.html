<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Orders | Inventory System</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<header>
  <h1>ğŸ§¾ Orders</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="inventory.html">Inventory</a>
    <a href="documents.html">Documents</a>
    <a href="log.html">Activity Log</a>
    <a href="sales.html">Sales</a>
    <a href="orders.html">Orders</a>

    <a href="company.html">Company</a>
    <a href="setting.html" style="text-decoration:none;"><button>âš™ï¸ Setting</button></a>

    <button onclick="toggleTheme()">ğŸŒ“ Mode</button>
    <button onclick="logout()">ğŸšª Logout</button>

    <div id="adminInfo">Logged in as: <span id="adminName"></span> (<span id="adminRole"></span>)</div>
  </nav>
</header>

<main>
  <section>
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <h2>Order Records</h2>
      <div style="display:flex;gap:8px;">
        <button id="downloadOrdersXLSXBtnInline" class="success-btn">â¬‡ï¸ Excel</button>
        <button id="downloadOrdersPDFBtn" class="secondary-btn">â¬‡ï¸ PDF</button>
        <button id="addOrderBtn" class="primary-btn">â• Create Order</button>
      </div>
    </div>

    <div class="table-container" style="margin-top:12px;">
      <table id="ordersTable">
        <thead>
          <tr>
            <th>Order #</th>
            <th>Customer</th>
            <th>Items</th>
            <th class="money">Total (RM)</th>
            <th>Status</th>
            <th>Date</th>
            <th class="actions">Actions</th>
          </tr>
        </thead>
        <tbody id="ordersList"></tbody>
      </table>
    </div>
  </section>
</main>

<script src="js/setting.js" defer></script>
<script src="js/script.js" defer></script>

<script>
  document.documentElement.dataset.page = "orders";

  document.addEventListener("DOMContentLoaded", () => {
    const adminName = sessionStorage.getItem("adminName");
    const adminRole = sessionStorage.getItem("adminRole");

    document.getElementById("adminName").textContent = adminName;
    document.getElementById("adminRole").textContent = adminRole;

    // PDF + Excel buttons
    document.querySelector("#downloadOrdersPDFBtn")
      ?.addEventListener("click", () => window.open(`${API_BASE}/orders/report/pdf`, "_blank"));

    document.querySelector("#downloadOrdersXLSXBtnInline")
      ?.addEventListener("click", () => {
        if (window.downloadOrdersReportXLSX) downloadOrdersReportXLSX();
      });

    // Create Order button
    document.querySelector("#addOrderBtn")
      ?.addEventListener("click", () => window.location.href = "order_edit.html");
  });
</script>
</body>
</html>
