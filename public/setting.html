<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Settings | Inventory System</title>
<link rel="stylesheet" href="css/style.css"/>
</head>
<body>
<header>
  <h1>âš™ï¸ Account Settings</h1>
    <nav>
      <a href="index.html">Dashboard</a>
      <a href="documents.html">Documents</a>
      <a href="log.html">Activity Log</a>
      <a href="setting.html" class="active" style="text-decoration: none;"><button>âš™ï¸ Setting</button></a>
      <button onclick="toggleTheme()">ğŸŒ“ Mode</button>
      <button onclick="logout()">ğŸšª Logout</button>
      <div id="adminInfo">Logged in as: <span id="adminName"></span></div>
    </nav>
  </header>

<section>
  <h2>Manager Account</h2>
  <div class="info-card">
    <p>Logged-in User: <strong id="currentUser"></strong></p>
  </div>

  <!-- Company Information Section - Now just a button -->
  <div style="margin-top: 30px; border-top: 1px solid var(--border-color); padding-top: 20px;">
    <h3>ğŸ¢ Company Information</h3>
    <p style="color: var(--secondary-color); margin-bottom: 20px;">
      Manage your company details that will appear on all reports and invoices.
    </p>
    
    <div style="text-align: center; margin: 30px 0;">
      <button onclick="openCompanyInfoModal()" class="primary-btn btn-large btn-icon">
        ğŸ¢ Manage Company Information
      </button>
      <p style="font-size: 0.85rem; color: var(--secondary-color); margin-top: 8px;">
        Click to view and edit company details
      </p>
    </div>
  </div>

  <!-- Password Change Section -->
  <div style="margin-top: 40px; border-top: 1px solid var(--border-color); padding-top: 20px;">
    <h3>ğŸ”’ Change Password</h3>
    
    <form id="passwordForm" style="margin-top: 20px;">
      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input id="newPassword" type="password" required />
      </div>
      
      <div class="form-group">
        <label for="confirmPassword">Confirm New Password</label>
        <input id="confirmPassword" type="password" required />
      </div>
      
      <div class="form-group">
        <label for="securityCode">Admin Security Code</label>
        <input id="securityCode" type="password" placeholder="Required to confirm change" required />
      </div>
      
      <button id="changePasswordBtn" type="button" class="primary-btn" style="margin-top: 15px;">
        ğŸ”’ Confirm Change Password
      </button>
      <p id="passwordMessage" style="margin-top: 10px;"></p>
    </form>
  </div>

  <!-- Account Actions Section -->
  <div style="margin-top: 40px; border-top: 1px solid var(--border-color); padding-top: 20px;">
    <h3>âš¡ Account Actions</h3>
    <div class="btn-group-horizontal" style="margin-top: 15px;">
      <button id="logoutBtn" type="button" class="secondary-btn" onclick="logout()">
        ğŸšª Logout
      </button>
      <button id="deleteAccountBtn" type="button" class="danger-btn">
        ğŸ—‘ï¸ Delete Account
      </button>
    </div>
  </div>
</section>

<!-- Company Information Modal -->
<div id="companyInfoModal" class="modal">
  <div class="modal-content x-large-modal">
    <div class="modal-header">
      <h2>ğŸ¢ Company Information</h2>
      <span class="close" id="closeCompanyInfoModal">&times;</span>
    </div>
    <div class="modal-body">
      
      <!-- Current Company Information Preview -->
      <div class="company-info-preview" style="margin-bottom: 30px;">
        <h3>Current Company Information</h3>
        <div class="detail-row">
          <div class="detail-group">
            <label>Company Name:</label>
            <span id="companyNameDisplay" class="detail-value">L&B Company</span>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-group full-width">
            <label>Address:</label>
            <span id="companyAddressDisplay" class="detail-value">Jalan Mawar 8, Taman Bukit Beruang Permai, Melaka</span>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-group">
            <label>Phone:</label>
            <span id="companyPhoneDisplay" class="detail-value">01133127622</span>
          </div>
          <div class="detail-group">
            <label>Email:</label>
            <span id="companyEmailDisplay" class="detail-value">lbcompany@gmail.com</span>
          </div>
        </div>
      </div>
      
      <!-- Edit Company Information Form -->
      <div class="company-info-form">
        <h3 style="margin-top: 0; margin-bottom: 20px;">âœï¸ Edit Company Information</h3>
        
        <div class="form-group">
          <label for="companyName">Company Name:</label>
          <input type="text" id="companyName" placeholder="Enter company name" />
        </div>
        
        <div class="form-group">
          <label for="companyAddress">Company Address:</label>
          <textarea id="companyAddress" placeholder="Enter company address" rows="3"></textarea>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="companyPhone">Phone Number:</label>
            <input type="text" id="companyPhone" placeholder="Enter phone number" />
          </div>
          <div class="form-group">
            <label for="companyEmail">Email Address:</label>
            <input type="email" id="companyEmail" placeholder="Enter email address" />
          </div>
        </div>
        
        <div class="modal-actions">
          <button onclick="closeCompanyInfoModal()" class="secondary-btn">
            âŒ Cancel
          </button>
          <button onclick="updateCompanyInfo()" class="primary-btn">
            ğŸ’¾ Save Changes
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- JS -->
<script src="js/setting.js" defer></script>
<script src="js/script.js" defer></script>
<script>
  // Tell script.js we are on the settings page so it can bind the password & delete account logic
  document.documentElement.dataset.page = 'setting';

  // Pre-fill current user
  document.addEventListener('DOMContentLoaded', async () => {
    const adminName = sessionStorage.getItem('adminName') || 'Guest';
    if (document.getElementById('adminName')) document.getElementById('adminName').textContent = adminName;
    if (document.getElementById('currentUser')) document.getElementById('currentUser').textContent = adminName;
    
    // Load company information (will be used in modal)
    await fetchCompanyInfo();
  });
</script>
</body>
</html>
